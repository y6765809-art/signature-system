<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¤×× ×œ × ×™×”×•×œ ×¨×™×©×™×•× ×•×ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: linear-gradient(to bottom, #ffffff 0%, #f5f5f5 100%);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
            color: #d4af37;
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #d4af37;
        }
        
        .header h1 {
            font-size: 2em;
            font-weight: 300;
            letter-spacing: 2px;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 25px;
            padding: 25px;
            background: #ffffff;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            border-right: 4px solid #d4af37;
        }
        
        .section h2 {
            color: #2c2c2c;
            margin-bottom: 15px;
            font-size: 1.4em;
            font-weight: 400;
            letter-spacing: 1px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        input[type="text"], input[type="email"], input[type="date"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.95em;
            margin: 8px 0;
            font-family: inherit;
            background: #fafafa;
        }
        
        input:focus {
            outline: none;
            border-color: #d4af37;
            background: #ffffff;
        }
        
        .btn {
            background: linear-gradient(135deg, #d4af37 0%, #c5a028 100%);
            color: #1a1a1a;
            border: none;
            padding: 12px 30px;
            font-size: 0.95em;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #e0bb47 0%, #d4af37 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #8b0000 0%, #660000 100%);
            color: #ffffff;
        }
        
        .btn-small {
            padding: 8px 18px;
            font-size: 0.85em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th {
            background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
            color: #d4af37;
            padding: 12px;
            text-align: right;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
            background: #fafafa;
        }
        
        tr:hover td {
            background: #ffffff;
        }
        
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status.active {
            background: #d4af37;
            color: #1a1a1a;
        }
        
        .status.inactive {
            background: #999;
            color: #fff;
        }
        
        .license-key {
            font-family: 'Courier New', monospace;
            background: #2c2c2c;
            color: #d4af37;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9em;
            display: inline-block;
            letter-spacing: 1px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            border-right: 4px solid;
        }
        
        .alert-success {
            background: #f0f8f0;
            color: #2d5016;
            border-color: #4a7c2c;
        }
        
        .alert-info {
            background: #f0f8ff;
            color: #1a4d7a;
            border-color: #5b9bd5;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-box {
            background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
            color: #d4af37;
            padding: 20px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid rgba(212,175,55,0.3);
        }
        
        .stat-box h3 {
            font-size: 2em;
            margin-bottom: 5px;
            font-weight: 300;
        }
        
        .stat-box p {
            color: #c0c0c0;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }
        
        .hidden {
            display: none;
        }
        
        label {
            display: block;
            font-weight: 500;
            margin: 12px 0 5px 0;
            color: #2c2c2c;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ×¤×× ×œ × ×™×”×•×œ ×¨×™×©×™×•× ×•×ª</h1>
            <p style="color: #c0c0c0; margin-top: 8px;">××¢×¨×›×ª ×—×ª×™××•×ª ×“×™×’×™×˜×œ×™×•×ª</p>
        </div>
        
        <div class="content">
            <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª -->
            <div class="stats">
                <div class="stat-box">
                    <h3 id="totalLicenses">0</h3>
                    <p>×¡×”"×› ×¨×™×©×™×•× ×•×ª</p>
                </div>
                <div class="stat-box">
                    <h3 id="activeLicenses">0</h3>
                    <p>×¨×™×©×™×•× ×•×ª ×¤×¢×™×œ×™×</p>
                </div>
                <div class="stat-box">
                    <h3 id="revenueEstimate">â‚ª0</h3>
                    <p>×”×›× ×¡×” ××©×•×¢×¨×ª</p>
                </div>
            </div>
            
            <!-- ×™×¦×™×¨×ª ×¨×™×©×™×•×Ÿ ×—×“×© -->
            <div class="section">
                <h2>â• ×™×¦×™×¨×ª ×¨×™×©×™×•×Ÿ ×—×“×©</h2>
                
                <label>×©× ×œ×§×•×—:</label>
                <input type="text" id="customerName" placeholder="×©× ××œ×">
                
                <label>××™××™×™×œ:</label>
                <input type="email" id="customerEmail" placeholder="email@example.com">
                
                <label>×¡×•×’ ×¨×™×©×™×•×Ÿ:</label>
                <select id="licenseType" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 4px; margin: 8px 0; background: #fafafa;">
                    <option value="lifetime">×œ×¦××™×ª×•×ª</option>
                    <option value="yearly">×©× ×ª×™</option>
                    <option value="monthly">×—×•×“×©×™</option>
                </select>
                
                <label>×ª××¨×™×š ×ª×¤×•×’×” (×× ×¨×œ×•×•× ×˜×™):</label>
                <input type="date" id="expiryDate">
                
                <label>××—×™×¨ (â‚ª):</label>
                <input type="text" id="price" placeholder="1500">
                
                <div style="margin-top: 15px;">
                    <button class="btn" onclick="generateLicense()">ğŸ« ×¦×•×¨ ×¨×™×©×™×•×Ÿ</button>
                </div>
                
                <div id="newLicenseResult" class="alert alert-success hidden">
                    <strong>×¨×™×©×™×•×Ÿ × ×•×¦×¨ ×‘×”×¦×œ×—×”!</strong><br>
                    ××¤×ª×—: <span class="license-key" id="newLicenseKey"></span><br>
                    <button class="btn btn-small" onclick="copyNewLicense()" style="margin-top: 10px;">ğŸ“‹ ×”×¢×ª×§ ××¤×ª×—</button>
                </div>
            </div>
            
            <!-- ×¨×©×™××ª ×¨×™×©×™×•× ×•×ª -->
            <div class="section">
                <h2>ğŸ“‹ ×¨×©×™××ª ×¨×™×©×™×•× ×•×ª</h2>
                
                <div class="alert alert-info">
                    <strong>×”×¢×¨×”:</strong> ×¨×©×™××” ×–×• × ×©××¨×ª ×‘××—×©×‘ ×©×œ×š (LocalStorage). ×œ×™×™×¦×•× ×œ×§×•×‘×¥ JSON, ×œ×—×¥ ×¢×œ "×™×™×¦× × ×ª×•× ×™×".
                </div>
                
                <div style="margin-bottom: 15px;">
                    <button class="btn btn-small" onclick="exportData()">ğŸ’¾ ×™×™×¦× × ×ª×•× ×™×</button>
                    <button class="btn btn-small" onclick="importData()">ğŸ“¥ ×™×™×‘× × ×ª×•× ×™×</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImport(event)">
                </div>
                
                <table id="licensesTable">
                    <thead>
                        <tr>
                            <th>××¤×ª×—</th>
                            <th>×œ×§×•×—</th>
                            <th>××™××™×™×œ</th>
                            <th>×ª××¨×™×š ×”×¤×¢×œ×”</th>
                            <th>×ª×¤×•×’×”</th>
                            <th>××—×™×¨</th>
                            <th>×¡×˜×˜×•×¡</th>
                            <th>×¤×¢×•×œ×•×ª</th>
                        </tr>
                    </thead>
                    <tbody id="licensesTableBody">
                    </tbody>
                </table>
            </div>
            
            <!-- ×§×•×“ ×œ×©×™×œ×•×‘ -->
            <div class="section">
                <h2>ğŸ”§ ×”×•×¨××•×ª ×”×ª×§× ×”</h2>
                
                <div class="alert alert-info">
                    <strong>×©×œ×‘ 1:</strong> ×”×¢×œ×” ××ª ×”×¤×•× ×§×¦×™×” <code>verify.js</code> ×œ-Netlify<br>
                    <strong>×©×œ×‘ 2:</strong> ×¢×“×›×Ÿ ××ª ×”×›×ª×•×‘×ª ×‘×§×•×‘×¥ ×”××¢×¨×›×ª<br>
                    <strong>×©×œ×‘ 3:</strong> ×¦×•×¨ ×¨×™×©×™×•× ×•×ª ×•×©×œ×— ×œ×œ×§×•×—×•×ª
                </div>
                
                <p style="margin-top: 15px;"><strong>URL ×©×œ ×”-API ×©×œ×š:</strong></p>
                <input type="text" id="apiUrl" placeholder="https://your-site.netlify.app/.netlify/functions/verify" style="font-family: 'Courier New', monospace;">
                
                <button class="btn btn-small" onclick="testAPI()" style="margin-top: 10px;">ğŸ§ª ×‘×“×•×§ ×—×™×‘×•×¨</button>
                
                <div id="apiTestResult" class="hidden" style="margin-top: 15px;"></div>
            </div>
        </div>
    </div>
    
    <script>
        let licenses = {};
        
        // ×˜×¢×™× ×” ×¨××©×•× ×™×ª
        window.onload = function() {
            loadLicenses();
            updateStats();
            renderTable();
        };
        
        // ×˜×¢×™× ×ª ×¨×™×©×™×•× ×•×ª ×-LocalStorage
        function loadLicenses() {
            const saved = localStorage.getItem('signature_licenses');
            if (saved) {
                licenses = JSON.parse(saved);
            } else {
                // ×¨×™×©×™×•× ×•×ª ×œ×“×•×’××”
                licenses = {
                    "SIG-2024-DEMO-TEST": {
                        active: true,
                        customer: "×œ×§×•×— ×œ×“×•×’××”",
                        email: "demo@example.com",
                        activatedAt: new Date().toISOString().split('T')[0],
                        expiresAt: null,
                        price: 0,
                        type: "demo"
                    }
                };
                saveLicenses();
            }
        }
        
        // ×©××™×¨×ª ×¨×™×©×™×•× ×•×ª
        function saveLicenses() {
            localStorage.setItem('signature_licenses', JSON.stringify(licenses));
        }
        
        // ×™×¦×™×¨×ª ××¤×ª×— ×¨×™×©×™×•×Ÿ ×™×™×—×•×“×™
        function generateKey() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            const parts = [];
            for (let i = 0; i < 3; i++) {
                let part = '';
                for (let j = 0; j < 4; j++) {
                    part += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                parts.push(part);
            }
            return 'SIG-2024-' + parts.join('-');
        }
        
        // ×™×¦×™×¨×ª ×¨×™×©×™×•×Ÿ ×—×“×©
        function generateLicense() {
            const customerName = document.getElementById('customerName').value.trim();
            const customerEmail = document.getElementById('customerEmail').value.trim();
            const licenseType = document.getElementById('licenseType').value;
            const expiryDate = document.getElementById('expiryDate').value;
            const price = document.getElementById('price').value.trim();
            
            if (!customerName || !customerEmail) {
                alert('× × ×œ××œ× ×©× ×•××™××™×™×œ');
                return;
            }
            
            const key = generateKey();
            
            licenses[key] = {
                active: true,
                customer: customerName,
                email: customerEmail,
                activatedAt: new Date().toISOString().split('T')[0],
                expiresAt: expiryDate || null,
                price: parseFloat(price) || 0,
                type: licenseType
            };
            
            saveLicenses();
            updateStats();
            renderTable();
            
            // ×”×¦×’×ª ×”××¤×ª×— ×”×—×“×©
            document.getElementById('newLicenseKey').textContent = key;
            document.getElementById('newLicenseResult').classList.remove('hidden');
            
            // × ×™×§×•×™ ×”×˜×•×¤×¡
            document.getElementById('customerName').value = '';
            document.getElementById('customerEmail').value = '';
            document.getElementById('expiryDate').value = '';
            document.getElementById('price').value = '';
        }
        
        // ×”×¢×ª×§×ª ××¤×ª×— ×—×“×©
        function copyNewLicense() {
            const key = document.getElementById('newLicenseKey').textContent;
            navigator.clipboard.writeText(key).then(() => {
                alert('×”××¤×ª×— ×”×•×¢×ª×§ ×œ×œ×•×—!');
            });
        }
        
        // ×¢×“×›×•×Ÿ ×¡×˜×˜×™×¡×˜×™×§×•×ª
        function updateStats() {
            const total = Object.keys(licenses).length;
            const active = Object.values(licenses).filter(l => l.active).length;
            const revenue = Object.values(licenses).reduce((sum, l) => sum + (l.price || 0), 0);
            
            document.getElementById('totalLicenses').textContent = total;
            document.getElementById('activeLicenses').textContent = active;
            document.getElementById('revenueEstimate').textContent = 'â‚ª' + revenue.toLocaleString();
        }
        
        // ×¨×™× ×“×•×¨ ×˜×‘×œ×”
        function renderTable() {
            const tbody = document.getElementById('licensesTableBody');
            tbody.innerHTML = '';
            
            Object.entries(licenses).forEach(([key, license]) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="license-key">${key}</span></td>
                    <td>${license.customer}</td>
                    <td>${license.email}</td>
                    <td>${license.activatedAt}</td>
                    <td>${license.expiresAt || '×œ×¦××™×ª×•×ª'}</td>
                    <td>â‚ª${license.price || 0}</td>
                    <td><span class="status ${license.active ? 'active' : 'inactive'}">${license.active ? '×¤×¢×™×œ' : '×œ× ×¤×¢×™×œ'}</span></td>
                    <td>
                        <button class="btn btn-small" onclick="copyKey('${key}')">×”×¢×ª×§</button>
                        <button class="btn btn-small ${license.active ? 'btn-danger' : ''}" onclick="toggleStatus('${key}')">${license.active ? '×”×©×‘×ª' : '×”×¤×¢×œ'}</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        // ×”×¢×ª×§×ª ××¤×ª×—
        function copyKey(key) {
            navigator.clipboard.writeText(key).then(() => {
                alert('×”××¤×ª×— ×”×•×¢×ª×§!');
            });
        }
        
        // ×©×™× ×•×™ ×¡×˜×˜×•×¡
        function toggleStatus(key) {
            licenses[key].active = !licenses[key].active;
            saveLicenses();
            updateStats();
            renderTable();
        }
        
        // ×™×™×¦×•× × ×ª×•× ×™×
        function exportData() {
            const dataStr = JSON.stringify(licenses, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'licenses-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
        }
        
        // ×™×™×‘×•× × ×ª×•× ×™×
        function importData() {
            document.getElementById('importFile').click();
        }
        
        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (confirm('×”×× ×œ×™×™×‘× ' + Object.keys(imported).length + ' ×¨×™×©×™×•× ×•×ª?')) {
                        licenses = imported;
                        saveLicenses();
                        updateStats();
                        renderTable();
                        alert('×”× ×ª×•× ×™× ×™×•×‘××• ×‘×”×¦×œ×—×”!');
                    }
                } catch (error) {
                    alert('×©×’×™××” ×‘×§×¨×™××ª ×”×§×•×‘×¥');
                }
            };
            reader.readAsText(file);
        }
        
        // ×‘×“×™×§×ª API
        function testAPI() {
            const url = document.getElementById('apiUrl').value.trim();
            
            if (!url) {
                alert('× × ×œ×”×–×™×Ÿ ×›×ª×•×‘×ª API');
                return;
            }
            
            const testKey = Object.keys(licenses)[0];
            
            fetch(url + '?key=' + testKey)
                .then(response => response.json())
                .then(data => {
                    const result = document.getElementById('apiTestResult');
                    result.className = 'alert ' + (data.valid ? 'alert-success' : 'alert-info');
                    result.innerHTML = '<strong>×ª×•×¦××ª ×‘×“×™×§×”:</strong><br>' + JSON.stringify(data, null, 2);
                    result.classList.remove('hidden');
                })
                .catch(error => {
                    const result = document.getElementById('apiTestResult');
                    result.className = 'alert alert-info';
                    result.innerHTML = '<strong>×©×’×™××”:</strong> ' + error.message;
                    result.classList.remove('hidden');
                });
        }
    </script>
</body>
</html>